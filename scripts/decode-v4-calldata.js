const ethers = require('ethers');

// The routeData from the failed transaction
const routeData = "0x3593564c000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000006938bfce0000000000000000000000000000000000000000000000000000000000000002100c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000003a0000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000300090b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000197faef3f59ec80113e773bb6206a17d183f97cb0000000000000000000000000000000000000000000000000000000000000bb8000000000000000000000000000000000000000000000000000000000000003c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011c37937e08000000000000000000000000000000000000000000000000000000008280080a99c000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000197faef3f59ec80113e773bb6206a17d183f97cb0000000000000000000000000000000000000000000000000011c37937e0800000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008280080a99c00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000008280080a99c";

const iface = new ethers.utils.Interface([
  'function execute(bytes commands, bytes[] inputs, uint256 deadline)'
]);

const decoded = iface.decodeFunctionData('execute', routeData);
console.log('Commands:', decoded.commands);
console.log('Number of inputs:', decoded.inputs.length);
console.log('Deadline:', decoded.deadline.toString());

console.log('\nInput 0 (V4_SWAP):');
console.log('  Raw:', decoded.inputs[0]);
console.log('  Length:', decoded.inputs[0].length);

// Try to decode the V4_SWAP input
try {
  const v4Input = ethers.utils.defaultAbiCoder.decode(['bytes', 'bytes[]'], decoded.inputs[0]);
  console.log('  Actions:', v4Input[0]);
  console.log('  Params count:', v4Input[1].length);
} catch (e) {
  console.log('  Failed to decode:', e.message);
}

console.log('\nInput 1 (UNWRAP_WETH):');
console.log('  Raw:', decoded.inputs[1]);
